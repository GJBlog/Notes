# HTTPS

## HTTP的缺点

* 通信使用明文(不加密)，内容可能会被窃听
* 不验证通信方的身份，因此有可能遭遇伪装
* 无法证明报文的完整性，所以有可能已遭篡改

### 通信使用明文可能会被窃听

* 本质上是因为HTTP本身不具备加密的功能，无法对通信整体(使用HTTP协议通信的请求和响应的内容)加密，所以HTTP报文使用明文方式发送

##### 加密处理防止窃听

目前在防止技术中主要以加密技术为主，加密的对象主要有

* **通信的加密**
    * 通过和SSL(secure Socket Layer)/TLS(Transport Layer Security)组合加密HTTP的通信内容。用 SSL 建立安全通信线路之后，就可以在这条线路上进行 HTTP 通信了。与 SSL 组合使用的 HTTP 被称为 HTTPS（HTTP Secure，超文本传输安全协议）或 HTTP over SSL
    
* **内容的加密**
    * 仅仅对报文主体里面的内容做加密处理，通信本身是不加密的。需要客户端和服务器同时具备加密和解密机制，内容仍有被篡改的风险

### 不验证通信方的身份就可能遭遇伪装

可能存在的安全隐患如下

* 无法确定请求发送至目标的 Web 服务器是否是按真实意图返回响应的那台服务器。有可能是已伪装的 Web 服务器 
* 无法确定响应返回到的客户端是否是按真实意图接收响应的那个客户端。有可能是已伪装的客户端。
* 无法确定正在通信的对方是否具备访问权限。因为某些 Web 服务器上保存着重要的信息，只想发给特定用户通信的权限
* 无法判定请求是来自何方、出自谁手
* 即使是无意义的请求也会照单全收。无法阻止海量请求下的 DoS 攻击（Denial of Service，拒绝服务攻击）

### 无法证明报文完整性，可能已遭篡改

* 中间人攻击：请求或响应在传输途中，遭遇攻击者拦截并篡改内容的攻击被称为中间人攻击(Man-in-the-Middle attack, MITM)

## HTTPS结构

* HTTPS = HTTP + 加密 + 认证 + 完整性保护
* 把添加了加密及认证机制的 HTTP 称为 HTTPS（HTTP Secure）
* HTTPS 并非是应用层的一种新协议。只是 HTTP 通信接口部分用 SSL（Secure Socket Layer）和 TLS（Transport Layer Security）协议代替而已
* 通常，HTTP 直接和 TCP 通信。当使用 SSL 时，则演变成先和 SSL 通信，再由 SSL 和 TCP 通信了

### SSL使用的公开秘钥加密技术

* 共享密钥加密的困境

    加密和解密同用一个密钥的方式称为共享密钥加密（Common key crypto system），也被叫做对称密钥加密
    
* 公开密钥加密的方式

    很好解决了共享密钥加密的问题。公开密钥加密使用一对非对称的密钥。一把叫做私有密钥（private key），另一把叫做公开密钥（public key）。顾名思义，私有密钥不能让其他任何人知道，而公开密钥则可以随意发布，任何人都可以获得
* HTTPS采用混合加密机制

    HTTPS 采用共享密钥加密和公开密钥加密两者并用的混合加密机制。若密钥能够实现安全交换，那么有可能会考虑仅使用公开密钥加密来通信。但是公开密钥加密与共享密钥加密相比，其处理速度要慢。所以应充分利用两者各自的优势，将多种方法组合起来用于通信。在交换密钥环节使用公开密钥加密方式，之后的建立通信交换报文阶段则使用共享密钥加密方式 